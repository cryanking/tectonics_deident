## TODO: add code sets for chronic pain,   



set_codes <- function(setx, thisname, local_set) {
for( i in local_set) {
  set(setx , i = NULL, j=thisname, value =setx[[thisname]] | grepl(setx[["ICD_10_CODES"]], pattern= i) )
}
}


set_all_codes <- function( data, code_list) {
    
    if(!("any_code" %in% colnames(data) )) {
      data[ , any_code := FALSE]
    }
    
    for (outer.i in names(code_list) ) {
      if( !(outer.i %in% colnames(data) ) ) {
        set( data , i = NULL, j=outer.i, value = FALSE)
      }
      
      for( thisname in code_list[[outer.i]] ) {
          set(data , i = grep(data[["ICD_10_CODES"]], pattern= thisname, fixed=TRUE), j=outer.i, value = TRUE  )
      }
      
      set(data , i = which( data[[outer.i]] == TRUE)  ,  j="any_code", value = TRUE)
    }
     
}

code_sets <- list()

local_set<- c(
"N19" , 
"I120" , 
"I132" , 
"I1311" , 
"N185" , 
"N186" , 
"R880" , 
"Z4901" , 
"Z4902" , 
"Z4931" , 
"Z4932" , 
"R880" , 
"Z9115" , 
"Z992")

code_sets[["ESRD"]] <- local_set

## ckd
local_set<- c(
'I129' , 
'I130' , 
'I1310' , 
'N182' , 
'N183' , 
'N184' , 
'N189' , 
'R34' ,  ## R34 is frequently used for acute states, because the POA flag is used it's ok
'K767'  ## HRS is not uncommonly acute, but by definition it is not caused by surgery
)

code_sets[["CKD"]] <- local_set


local_set<- c(
'E089' , 
'E099' , 
'E109' , 
'E119' , 
'E139' , 
'R739' , 
'R81' , 
'Z4681' , 
'Z9641' , 
'E0800' , 
'E0801' , 
'E0810' , 
'E0811' , 
'E0821' , 
'E0822' , 
'E0829' , 
'E08311' , 
'E08319' , 
'E08321' , 
'E083211' , 
'E083212' , 
'E083213' , 
'E083219' , 
'E08329' , 
'E083291' , 
'E083292' , 
'E083293' , 
'E083299' , 
'E08331' , 
'E083311' , 
'E083312' , 
'E083313' , 
'E083319' , 
'E08339' , 
'E083391' , 
'E083392' , 
'E083393' , 
'E083399' , 
'E08341' , 
'E083411' , 
'E083412' , 
'E083413' , 
'E083419' , 
'E08349' , 
'E083491' , 
'E083492' , 
'E083493' , 
'E083499' , 
'E08351' , 
'E083511' , 
'E083512' , 
'E083513' , 
'E083519' , 
'E083521' , 
'E083522' , 
'E083523' , 
'E083529' , 
'E083531' , 
'E083532' , 
'E083533' , 
'E083539' , 
'E083541' , 
'E083542' , 
'E083543' , 
'E083549' , 
'E083551' , 
'E083552' , 
'E083553' , 
'E083559' , 
'E08359' , 
'E083591' , 
'E083592' , 
'E083593' , 
'E083599' , 
'E0836' , 
'E0837X1' , 
'E0837X2' , 
'E0837X3' , 
'E0837X9' , 
'E0839' , 
'E0840' , 
'E0841' , 
'E0842' , 
'E0843' , 
'E0844' , 
'E0849' , 
'E0851' , 
'E0852' , 
'E0859' , 
'E08610' , 
'E08618' , 
'E08620' , 
'E08621' , 
'E08622' , 
'E08628' , 
'E08630' , 
'E08638' , 
'E08641' , 
'E08649' , 
'E0865' , 
'E0869' , 
'E088' , 
'E0900' , 
'E0901' , 
'E0910' , 
'E0911' , 
'E0921' , 
'E0922' , 
'E0929' , 
'E09311' , 
'E09319' , 
'E09321' , 
'E093211' , 
'E093212' , 
'E093213' , 
'E093219' , 
'E09329' , 
'E093291' , 
'E093292' , 
'E093293' , 
'E093299' , 
'E09331' , 
'E093311' , 
'E093312' , 
'E093313' , 
'E093319' , 
'E09339' , 
'E093391' , 
'E093392' , 
'E093393' , 
'E093399' , 
'E09341' , 
'E093411' , 
'E093412' , 
'E093413' , 
'E093419' , 
'E09349' , 
'E093491' , 
'E093492' , 
'E093493' , 
'E093499' , 
'E09351' , 
'E093511' , 
'E093512' , 
'E093513' , 
'E093519' , 
'E093521' , 
'E093522' , 
'E093523' , 
'E093529' , 
'E093531' , 
'E093532' , 
'E093533' , 
'E093539' , 
'E093541' , 
'E093542' , 
'E093543' , 
'E093549' , 
'E093551' , 
'E093552' , 
'E093553' , 
'E093559' , 
'E09359' , 
'E093591' , 
'E093592' , 
'E093593' , 
'E093599' , 
'E0936' , 
'E0937X1' , 
'E0937X2' , 
'E0937X3' , 
'E0937X9' , 
'E0939' , 
'E0940' , 
'E0941' , 
'E0942' , 
'E0943' , 
'E0944' , 
'E0949' , 
'E0951' , 
'E0952' , 
'E0959' , 
'E09610' , 
'E09618' , 
'E09620' , 
'E09621' , 
'E09622' , 
'E09628' , 
'E09630' , 
'E09638' , 
'E09641' , 
'E09649' , 
'E0965' , 
'E0969' , 
'E098' , 
'E1010' , 
'E1011' , 
'E1021' , 
'E1022' , 
'E1029' , 
'E10311' , 
'E10319' , 
'E10321' , 
'E103211' , 
'E103212' , 
'E103213' , 
'E103219' , 
'E10329' , 
'E103291' , 
'E103292' , 
'E103293' , 
'E103299' , 
'E10331' , 
'E103311' , 
'E103312' , 
'E103313' , 
'E103319' , 
'E10339' , 
'E103391' , 
'E103392' , 
'E103393' , 
'E103399' , 
'E10341' , 
'E103411' , 
'E103412' , 
'E103413' , 
'E103419' , 
'E10349' , 
'E103491' , 
'E103492' , 
'E103493' , 
'E103499' , 
'E10351' , 
'E103511' , 
'E103512' , 
'E103513' , 
'E103519' , 
'E103521' , 
'E103522' , 
'E103523' , 
'E103529' , 
'E103531' , 
'E103532' , 
'E103533' , 
'E103539' , 
'E103541' , 
'E103542' , 
'E103543' , 
'E103549' , 
'E103551' , 
'E103552' , 
'E103553' , 
'E103559' , 
'E10359' , 
'E103591' , 
'E103592' , 
'E103593' , 
'E103599' , 
'E1036' , 
'E1037X1' , 
'E1037X2' , 
'E1037X3' , 
'E1037X9' , 
'E1039' , 
'E1040' , 
'E1041' , 
'E1042' , 
'E1043' , 
'E1044' , 
'E1049' , 
'E1051' , 
'E1052' , 
'E1059' , 
'E10610' , 
'E10618' , 
'E10620' , 
'E10621' , 
'E10622' , 
'E10628' , 
'E10630' , 
'E10638' , 
'E10641' , 
'E10649' , 
'E1065' , 
'E1069' , 
'E108' , 
'E1100' , 
'E1101' , 
'E1110' , 
'E1111' , 
'E1121' , 
'E1122' , 
'E1129' , 
'E11311' , 
'E11319' , 
'E11321' , 
'E113211' , 
'E113212' , 
'E113213' , 
'E113219' , 
'E11329' , 
'E113291' , 
'E113292' , 
'E113293' , 
'E113299' , 
'E11331' , 
'E113311' , 
'E113312' , 
'E113313' , 
'E113319' , 
'E11339' , 
'E113391' , 
'E113392' , 
'E113393' , 
'E113399' , 
'E11341' , 
'E113411' , 
'E113412' , 
'E113413' , 
'E113419' , 
'E11349' , 
'E113491' , 
'E113492' , 
'E113493' , 
'E113499' , 
'E11351' , 
'E113511' , 
'E113512' , 
'E113513' , 
'E113519' , 
'E113521' , 
'E113522' , 
'E113523' , 
'E113529' , 
'E113531' , 
'E113532' , 
'E113533' , 
'E113539' , 
'E113541' , 
'E113542' , 
'E113543' , 
'E113549' , 
'E113551' , 
'E113552' , 
'E113553' , 
'E113559' , 
'E11359' , 
'E113591' , 
'E113592' , 
'E113593' , 
'E113599' , 
'E1136' , 
'E1137X1' , 
'E1137X2' , 
'E1137X3' , 
'E1137X9' , 
'E1139' , 
'E1140' , 
'E1141' , 
'E1142' , 
'E1143' , 
'E1144' , 
'E1149' , 
'E1151' , 
'E1152' , 
'E1159' , 
'E11610' , 
'E11618' , 
'E11620' , 
'E11621' , 
'E11622' , 
'E11628' , 
'E11630' , 
'E11638' , 
'E11641' , 
'E11649' , 
'E1165' , 
'E1169' , 
'E118' , 
'E1300' , 
'E1301' , 
'E1310' , 
'E1311' , 
'E1321' , 
'E1322' , 
'E1329' , 
'E13311' , 
'E13319' , 
'E13321' , 
'E133211' , 
'E133212' , 
'E133213' , 
'E133219' , 
'E13329' , 
'E133291' , 
'E133292' , 
'E133293' , 
'E133299' , 
'E13331' , 
'E133311' , 
'E133312' , 
'E133313' , 
'E133319' , 
'E13339' , 
'E133391' , 
'E133392' , 
'E133393' , 
'E133399' , 
'E13341' , 
'E133411' , 
'E133412' , 
'E133413' , 
'E133419' , 
'E13349' , 
'E133491' , 
'E133492' , 
'E133493' , 
'E133499' , 
'E13351' , 
'E133511' , 
'E133512' , 
'E133513' , 
'E133519' , 
'E133521' , 
'E133522' , 
'E133523' , 
'E133529' , 
'E133531' , 
'E133532' , 
'E133533' , 
'E133539' , 
'E133541' , 
'E133542' , 
'E133543' , 
'E133549' , 
'E133551' , 
'E133552' , 
'E133553' , 
'E133559' , 
'E13359' , 
'E133591' , 
'E133592' , 
'E133593' , 
'E133599' , 
'E1336' , 
'E1337X1' , 
'E1337X2' , 
'E1337X3' , 
'E1337X9' , 
'E1339' , 
'E1340' , 
'E1341' , 
'E1342' , 
'E1343' , 
'E1344' , 
'E1349' , 
'E1351' , 
'E1352' , 
'E1359' , 
'E13610' , 
'E13618' , 
'E13620' , 
'E13621' , 
'E13622' , 
'E13628' , 
'E13630' , 
'E13638' , 
'E13641' , 
'E13649' , 
'E1365' , 
'E1369' , 
'E138' )


code_sets[["Diabetes"]] <- local_set



local_set<- c(
'E109' , 
'E1010' , 
'E1011' , 
'E1021' , 
'E1022' , 
'E1029' , 
'E10311' , 
'E10319' , 
'E10321' , 
'E103211' , 
'E103212' , 
'E103213' , 
'E103219' , 
'E10329' , 
'E103291' , 
'E103292' , 
'E103293' , 
'E103299' , 
'E10331' , 
'E103311' , 
'E103312' , 
'E103313' , 
'E103319' , 
'E10339' , 
'E103391' , 
'E103392' , 
'E103393' , 
'E103399' , 
'E10341' , 
'E103411' , 
'E103412' , 
'E103413' , 
'E103419' , 
'E10349' , 
'E103491' , 
'E103492' , 
'E103493' , 
'E103499' , 
'E10351' , 
'E103511' , 
'E103512' , 
'E103513' , 
'E103519' , 
'E103521' , 
'E103522' , 
'E103523' , 
'E103529' , 
'E103531' , 
'E103532' , 
'E103533' , 
'E103539' , 
'E103541' , 
'E103542' , 
'E103543' , 
'E103549' , 
'E103551' , 
'E103552' , 
'E103553' , 
'E103559' , 
'E10359' , 
'E103591' , 
'E103592' , 
'E103593' , 
'E103599' , 
'E1036' , 
'E1037X1' , 
'E1037X2' , 
'E1037X3' , 
'E1037X9' , 
'E1039' , 
'E1040' , 
'E1041' , 
'E1042' , 
'E1043' , 
'E1044' , 
'E1049' , 
'E1051' , 
'E1052' , 
'E1059' , 
'E10610' , 
'E10618' , 
'E10620' , 
'E10621' , 
'E10622' , 
'E10628' , 
'E10630' , 
'E10638' , 
'E10641' , 
'E10649' , 
'E1065' , 
'E1069' , 
'E108' 
 )
code_sets[["DM_Type1"]] <- local_set

